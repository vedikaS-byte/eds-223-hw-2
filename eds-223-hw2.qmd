---
title: "Exploring Patterns of Environmental Justice in Los Angeles County"
author: "Vedika Shirtekar" 
date: "10/19/2025"
format:
  pdf: 
    code-fold: false
execute: 
  warning: false
  message: false
editor: 
  markdown: 
    wrap: 72
editor_options: 
  chunk_output_type: console
---

# Exploring Patterns of Environmental Justice in Los Angeles County

## Primary Objective

With an estimated 9.8 million residents in 2023, Los Angeles County is
the most populous county in California and the entire United States
(Data USA, n.d.). Los Angeles County is also racially diverse, with
approximately 2.48 million White (non-Hispanic) residents, 2.26 million
Hispanic residents, 1.4 million Asian residents, and 743,000 Black
residents (Data USA, n.d.). The city has a rich history and is
culturally diverse; however, marginalized communities continue to face
disproportionate environmental, social, and economic burdens.

Environmental injustices experienced by marginalized communities are
interconnected with patterns of reduced biodiversity in urban
environments. The Home Ownersâ€™ Loan Corporation (HOLC) created a
neighborhood ranking system to guide mortgage lending decisions,
classifying areas from A (green) to D (red) based on perceived
neighborhood safety (Oliver, 2025). This system was later used to deny
home loans and other financial opportunities to residents in lower-rated
neighborhoods, which were often predominantly inhabited by people of
color (Oliver, 2025). This practice is known as "redlining", defined as
the process of refusing financial support to a community based on
discriminatory practices (Merriam-Webster Legal, n.d.). Reduced
biodiversity in redlined neighborhoods is also a concern, as these areas
tend to face increased heating from impervious cover and reduced
greenery (Hoffman et al., 2020). In their study, Ellis-Soto et al.
emphasize the need for increased sampling in historically redlined areas
to establish a baseline for conservation efforts in urban environments.

The goal of this analysis is to examine the impacts of historical
redlining on marginalized communities and biodiversity in Los Angeles
(LA) using census block data, a HOLC grading map of LA, and bird
observation records. The following research question guided this
analysis:

**To what extent has historical redlining in Los Angeles contributed to
current disparities in environmental quality and urban biodiversity?**

### Loading Appropriate Packages

1.  Load the appropriate packages for the analysis.

```{r}
#| include: false
# Import packages
library(here) # Load "here" to locate and reference files
library(tidyverse) # Load the tidyverse" for data cleaning
library(sf) # Load "sf" for GIS analysis
library(ggplot2) # Load "ggplot2" for data visualization
library(tmap) # Load "tmap" for functions to create and layer maps
library(kableExtra) # Load "kableExtra" for table formatting
```

### Importing Data

2.  Import the geodatabase of `EJ Screen` data, the shape file of bird
    observations, and the json file of HOLC redlining neighborhoods in
    LA using `st_read()`.

```{r}
#| output: false
# Load in the data using st_read()

# Environmental injustice data from EJSCREEN
ej_screen <- st_read(here::here("data","ejscreen", "EJSCREEN_2023_BG_StatePct_with_AS_CNMI_GU_VI.gdb"))

# Bird observations
birds <- st_read(here::here("data","gbif-birds-LA", "gbif-birds-LA.shp"))

# HOLC inequality data
inequal <- st_read(here::here("data","mapping-inequality", "mapping-inequality-los-angeles.json"))
```

## Part 1: Legacy of Redlining in Current Environmental Injustice

A map was created to visualize historical redlining in Los Angeles and
its legacy on present-day environmental justice.

3.  Ensure that all spatial objects are in the same coordinate reference
    system (CRS) using `st_crs()`. Spatial objects were transformed to
    match the same CRS as `ej_screen` using `st_transform()`, and
    boolean checks were run to ensure the CRS matched for each spatial
    object.

```{r}
# Check CRS for all
st_crs(ej_screen)$Name # WGS 84 / Pseudo-Mercator 
st_crs(birds)$Name  # WGS 84 
st_crs(inequal)$Name # WGS 84 
```

```{r}
# Transform to match same CRS as ej_screen
birds <- st_transform(birds, st_crs(ej_screen))
inequal <- st_transform(inequal, st_crs(ej_screen))

# Double check to ensure all match
st_crs(ej_screen) == st_crs(birds)
st_crs(ej_screen) == st_crs(inequal)
st_crs(birds) == st_crs(inequal)
```

### Map of Historical Redlining in Los Angeles (HOLC)

4.  Create a map for neighborhoods colored by HOLC grade with an
    appropriate base map using functions in `tmap`. A format for the
    base map was selected from an extension of
    [Leaflet](https://github.com/leaflet-extras/leaflet-providers?tab=readme-ov-file)
    and used with `tm_tiles()`.

```{r}
map1 <- tm_shape(inequal) + # Call spatial data source
  tm_tiles("CartoDB.Positron") + #Establish basemap with tm_tiles using a view from Leaflet
  tm_polygons(
    col = "grade", # Color by HOLC grade
    palette = "brewer.Reds", # Utilize color palette
    alpha = 0.7, # Adjust transparency                      
    border.col = "black", # Border of graded neighborhoods
    title = "HOLC Grade")   + # Title of legend
  tm_compass(position = c("left", "top")) + # Compass
  tm_scalebar(position = c("left", "bottom")) + # Adjust placement of scale bar
  tm_graticules( # Add graticules to establish latitude and longitude network
    col = "black",
    lwd = 0.3, # Establish "thickness" of lines
    alpha = 0.6 ) +  # Specify transparency 
  tm_layout( # Center title outside bounding box
    main.title = "Historical Redlining in Los Angeles (HOLC)", 
    title.size = 1,
    legend.outside = TRUE, # Place legend outside map frame
    legend.outside.position = "right",
    component.autoscale = FALSE # Disable autoscaling for title
  )

# Store in variable for reproducibility
map1

# Save map to figs
tmap_save(map1, "figs/LA_HOC.png")
```

### Summary Table of Census Block Groups Inside or Outside HOLC Grade

To evaluate patterns of enviornmental injustice, a summary table was
created showing the proportion of census block groups that do and do not
fall within each HOLC grade.

5.  Filter `ej_screen` for observations within LA county such that all
    LA census blocks are obtained.

```{r}
# Filter for observations within LA county, not the whole country
ej_la <- ej_screen %>% filter(
  STATE_NAME == "California", 
  CNTY_NAME == "Los Angeles County") 
# Keep all LA census blocks and not just ones that intersect HOLC polygons
```

6.  Perform a spatial (left) join to attach attributes from `inequal` to
    each feature in `ej_la` based on spatial overlap, linking census
    block groups to a corresponding HOLC grade while retaining all
    census data. Strip geometries with st_drop_geometry() to remove the
    spatial information.

```{r}
# Perform a left join to join spatial overlaps
census_holc <- st_join(ej_la, inequal, left = T)
# Default spatial predicate is st_intersects (any block that touches or overlaps a HOLC polygon gets matched)

# Drop geometries
census_holc_df <- st_drop_geometry(census_holc)
```

7.  Summarize the percentage of census blocks in or outside a HOLC
    grade. Format the proportions as a table using
    [functions](https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html)
    in kableExtra. "NA" values stored as HOLC grades are interpreted as
    a census blocks not covered by the historical redlining map; the
    census block falls outside HOLC mapped areas.

```{r}
census_summary <- census_holc_df %>%
  mutate(
    grade = ifelse(is.na(grade), # Replace "NA" with "No HOLC grade" if NA
                   "No HOLC grade", 
                   grade)) %>% # Else leave assigned grade untouched
  group_by(grade) %>% # Group by grade
  summarise(count = n())%>% # Count # of rows in each grade group
  # Calculate % of census blocks in each grade over the total observations 
  mutate(percent = round(100 * count / sum(count), 2)) # Round to nearest hundreth

print(census_summary)
```

```{r}
# Format output as table
census_summary %>% 
  kbl() %>% # Call html format
  kable_styling() # Formatted borders
```

### Visualizing Current Environmental Justice Conditions in Redlined LA Communties

To

3.  Create at least two visualizations summarizing current conditions
    (from the EJScreen data) within HOLC grades using the mean of the
    following variables (you may combine variables or create separate
    plots):

-   \% low income
-   percentile for Particulate Matter 2.5
-   percentile for low life expectancy -Use ggplot for your
    visualizations! You will first need to calculate mean of each
    variable grouped by HOLC grade.

```{r}
holc_summary <- census_holc_df %>%
  group_by(grade) %>% 
  mutate(grade = ifelse(is.na(grade), "No HOLC grade", grade)) %>%
  filter(grade != "No HOLC grade") %>%
  summarise(
    mean_low_income = mean(P_LOWINCPCT, na.rm = TRUE),
    mean_pm25 = mean(P_PM25, na.rm = TRUE),
    mean_low_life_exp = mean(P_LIFEEXPPCT, na.rm = TRUE)
  ) %>%
  pivot_longer(
    cols = starts_with("mean_"),
    names_to = "socio_economic",
    values_to = "mean_value"
  ) 

# bar plot: mean value for each variable by HOLC grade
holc_summary %>% ggplot(aes(x = grade, y = mean_value, fill = grade)) +
  geom_col() +
  facet_wrap(~ socio_economic, scales = "free_y") +
  labs(
    x = "HOLC Grade",
    y = "Mean Value",
    title = "Mean EJScreen Indicators by HOLC Grade"
  ) +
  theme_bw() + 
  theme(legend.position = "none") 

# 
# ggplot(holc_summary, aes(x = grade, y = mean_value, color = grade)) +
#   geom_point(size = 3) +
#   facet_wrap(~ variable, scales = "free_y") +
#   labs(
#     x = "HOLC Grade",
#     y = "Mean Value",
#     title = "Mean EJScreen Indicators by HOLC Grade"
#   ) +
#   theme_minimal() +
#   theme(legend.position = "none")

```

Write a brief paragraph reflecting on these results. Interpret the
patterns you observe in your results. Discuss potential relationships
between historical redlining grades and current
environmental/socioeconomic conditions.

## Part 2: Legacy of redlining in biodiversity observations

Description For this assignment, you must produce the following based on
observations from 2021-2023:

1.  A figure summarizing the percent of bird observations within
    redlined neighborhoods within each HOLC grade

Create a visualizations that shows: - The percentage of bird
observations within each HOLC grade

```{r}
# Ensure in same CRS! 
st_crs(birds) == st_crs(inequal) # Yes they match 


# Perform spatial join to assign each bird observation to a HOLC grade polygon
# st_intersects so points on borders are included in spatial 
birds_holc <- st_join(birds, inequal, join = st_intersects, left = FALSE)

# Summarize % of bird observations by HOLC grade
bird_summary <- birds_holc %>%
  st_drop_geometry() %>% #
  group_by(grade) %>%
  summarise(count = n()) %>%
  mutate(percent = round(100 * (count / sum(count)), 2),
         grade = factor(grade, levels = c("A","B","C","D"))) %>%
  arrange(grade)

print(bird_summary)

# creat a pallete for each grade (percent of bird observations per HOLC grade)
grade_colors <- c("A" = "#2ca25f",
                  "B" = "#99d8c9",
                  "C" = "#fec44f",
                  "D" = "#de2d26")

bird_summary %>% ggplot(aes(x = grade, y = percent, fill = grade)) +
  geom_col(width = 0.7) +
  geom_text(aes(label = paste0(percent, "%")), vjust = -0.5, size = 3.5) +
  scale_fill_manual(values = grade_colors) +
  labs(
    title = "Percent of Bird Observations (2021â€“2023) within HOLC Grades",
    x = "HOLC Grade",
    y = "Percent of Bird Observations",
    caption = "Bird observations within Los Angeles HOLC neighborhoods (2021â€“2023)."
  ) +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"))



```

-   Include an appropiate title, axis labels, and legend
-   Hints: Ensure the bird observations and HOLC dataset have matching
    CRSâ€™, then perform a spatial join to assign each bird observations
    to a corresponding HOLC grade.
-   Spolier alert!! Our results donâ€™t match the findings from Ellis-Soto
    et al. 2023! Read the abstract of the study. Why might we have
    obtained different results in our analysis? What did the paper
    consider that we did not?

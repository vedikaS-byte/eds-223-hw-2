---
title: "Exploring Patterns of Environmental Justice in Los Angeles County"
author: "Vedika Shirtekar" 
date: "10/19/2025"
format:
  pdf: 
    code-fold: false
execute: 
  warning: false
  message: false
editor: 
  markdown: 
    wrap: 72
editor_options: 
  chunk_output_type: console
---

# Exploring Patterns of Environmental Justice in Los Angeles County

## Primary Objective

With an estimated 9.8 million residents in 2023, Los Angeles County is
the most populous county in California and the entire United States
(Data USA, n.d.). Los Angeles County is also racially diverse, with
approximately 2.48 million White (non-Hispanic) residents, 2.26 million
Hispanic residents, 1.4 million Asian residents, and 743,000 Black
residents (Data USA, n.d.). The city has a rich history and is
culturally diverse; however, marginalized communities continue to face
disproportionate environmental, social, and economic burdens.

Environmental injustices experienced by marginalized communities are
interconnected with patterns of reduced biodiversity in urban
environments. The Home Owners’ Loan Corporation (HOLC) created a
neighborhood ranking system to guide mortgage lending decisions,
classifying areas from A (green) to D (red) based on perceived
neighborhood safety (Oliver, 2025). This system was later used to deny
home loans and other financial opportunities to residents in lower-rated
neighborhoods, which were often predominantly inhabited by people of
color (Oliver, 2025). This practice is known as "redlining", defined as
the process of refusing financial support to a community based on
discriminatory practices (Merriam-Webster Legal, n.d.). Reduced
biodiversity in redlined neighborhoods is also a concern, as these areas
tend to face increased heating from impervious cover and reduced
greenery (Hoffman et al., 2020). In their study, Ellis-Soto et al.
emphasize the need for increased sampling in historically redlined areas
to establish a baseline for conservation efforts in urban environments.

The goal of this analysis is to examine the impacts of historical
redlining on marginalized communities and biodiversity in Los Angeles
(LA) using census block data, a HOLC grading map of LA, and bird
observation records. Detailed descriptions of each dataset can be found
in the README. The following research question guided this analysis:

**To what extent has historical redlining in Los Angeles contributed to
current disparities in environmental quality and urban biodiversity?**

### Loading Appropriate Packages

1.  Load the appropriate packages for the analysis.

```{r}
#| include: false
# Import packages
library(here) # Load "here" to locate and reference files
library(tidyverse) # Load the tidyverse" for data cleaning
library(sf) # Load "sf" for GIS analysis
library(ggplot2) # Load "ggplot2" for data visualization
library(tmap) # Load "tmap" for functions to create and layer maps
library(kableExtra) # Load "kableExtra" for table formatting
```

### Importing Data

2.  Import the geodatabase of `EJ Screen` data, the shape file of bird
    observations, and the json file of HOLC redlining neighborhoods in
    LA using `st_read()`.

```{r}
#| output: false
# Load in the data using st_read()

# Environmental injustice data from EJSCREEN
ej_screen <- st_read(here::here("data","ejscreen", 
                                "EJSCREEN_2023_BG_StatePct_with_AS_CNMI_GU_VI.gdb"))

# Bird observations
birds <- st_read(here::here("data","gbif-birds-LA", "gbif-birds-LA.shp"))

# HOLC inequality data
inequal <- st_read(here::here("data","mapping-inequality", 
                              "mapping-inequality-los-angeles.json"))
```

## Part 1: Legacy of Redlining in Current Environmental Injustice

A map was created to visualize historical redlining in Los Angeles and
its legacy on present-day environmental justice.

3.  Ensure that all spatial objects are in the same coordinate reference
    system (CRS) using `st_crs()`. Spatial objects were transformed to
    match the same CRS as `ej_screen` using `st_transform()`, and
    boolean checks were run to ensure the CRS matched for each spatial
    object.

```{r}
# Check CRS for all
st_crs(ej_screen)$Name # WGS 84 / Pseudo-Mercator 
st_crs(birds)$Name  # WGS 84 
st_crs(inequal)$Name # WGS 84 
```

```{r}
# Transform to match same CRS as ej_screen
birds <- st_transform(birds, st_crs(ej_screen))
inequal <- st_transform(inequal, st_crs(ej_screen))

# Double check to ensure all match
st_crs(ej_screen) == st_crs(birds)
st_crs(ej_screen) == st_crs(inequal)
st_crs(birds) == st_crs(inequal)
```

### Map of Historical Redlining in Los Angeles (HOLC)

4.  Create a map for neighborhoods colored by HOLC grade with an
    appropriate base map using functions in `tmap`. A format for the
    base map was selected from an extension of
    [Leaflet](https://github.com/leaflet-extras/leaflet-providers?tab=readme-ov-file)
    and used with `tm_tiles()`.

```{r}

map1 <- tm_shape(inequal) + # Call spatial data source
# Establish basemap with tm_tiles using view from Leaflet
  tm_tiles("CartoDB.Positron") + 
  tm_polygons(
    col = "grade", # Color by HOLC grade
    palette = "reds", # Utilize color palette
    na.color = "grey",
    alpha = 0.7, # Adjust transparency                      
    border.col = "black", # Border of graded neighborhoods
    title = "HOLC Grade")   + # Title of legend
  tm_compass(position = c("left", "top")) + # Compass
  tm_scalebar(position = c("left", "bottom")) + # Adjust placement of scale bar
  tm_graticules( # Add graticules to establish latitude and longitude network
    col = "black",
    lwd = 0.3, # Establish "thickness" of lines
    alpha = 0.6 ) +  # Specify transparency 
  tm_layout( # Center title outside bounding box
    main.title = "Historical Redlining in Los Angeles (HOLC)", 
    title.size = 1,
    legend.outside = TRUE, # Place legend outside map frame
    legend.outside.position = "right",
    component.autoscale = FALSE # Disable autoscaling for title
  )

# Store in variable for reproducibility
map1

# Save map to figs
tmap_save(map1, "figs/LA_HOC.png")
```

![](figs/LA_HOC.png)

***Figure 1. Finalized map of census blocks within or located outside a
HOLC graded redlined area. Areas graded “A” (light red) were considered
“safe,” while those graded “D” (dark red) were considered “unsafe.”***

### Summary Table of Census Block Groups Inside or Outside HOLC Grade

To evaluate patterns of environmental injustice, a summary table was
created showing the proportion of census block groups that do and do not
fall within each HOLC grade.

5.  Filter `ej_screen` for observations within LA county such that all
    LA census blocks are obtained.

```{r}
# Filter for observations within LA county, not the whole country
ej_la <- ej_screen %>% filter(
  STATE_NAME == "California", 
  CNTY_NAME == "Los Angeles County") 
# Keep all LA census blocks and not just ones that intersect HOLC polygons
```

6.  Perform a spatial (left) join to attach attributes from `inequal` to
    each feature in `ej_la` based on spatial overlap, linking census
    block groups to a corresponding HOLC grade while retaining all
    census data. Strip geometries with st_drop_geometry() to remove the
    spatial information.

```{r}
# Perform a left join to join spatial overlaps
census_holc <- st_join(ej_la, inequal, left = T)
# Default spatial predicate is st_intersects 
# (any block that touches or overlaps a HOLC polygon gets matched)

# Drop geometries
census_holc_df <- st_drop_geometry(census_holc)
```

7.  Summarize the percentage of census blocks in or outside a HOLC
    grade. Format the proportions as a table using
    [functions](https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html)
    in `kableExtra`. "NA" values stored as HOLC grades are interpreted
    as a census block not covered by the historical redlining map; the
    census block falls outside HOLC mapped areas.

```{r}
census_summary <- census_holc_df %>%
  mutate(
    grade = ifelse(is.na(grade), # Replace "NA" with "No HOLC grade" if NA
                   "No HOLC grade", 
                   grade)) %>% # Else leave assigned grade untouched
  group_by(grade) %>% # Group by grade
  summarise(count = n())%>% # Count # of rows in each grade group
  # Calculate % of census blocks in each grade over the total observations 
  mutate(percent = round(100 * count / sum(count), 2)) # Round to nearest hundreth
```

```{r}
# Format output as table
census_summary %>% 
  rename("Count of Census Blocks" = count, # Rename count
  "Percent of Census Blocks in HOLC Grade" = percent, # Rename percent
  "HOLC Grade" = grade) %>% # Rename grade
  kbl( # Call html format 
  caption = "Summary of Census Blocks by HOLC Grade") %>% # Title
  kable_styling() # Formatted borders
```

### Visualizing Current Environmental Justice Conditions in Redlined LA Communities

Two graphs were created to visualize current environmental conditions
(`ej_la`) within HOLC grades based on the average of the following
socioeconomic variables:

-   Percent low income

-   Percentile for Particulate Matter 2.5

-   Percentile for low life expectancy

8.  Calculate the mean of each socioeconomic variable grouped by HOLC
    grade. Create a singular column for socioeconomic variables to
    visually compare each average among HOLC grades.

```{r}
holc_summary <- census_holc_df %>%
  group_by(grade) %>% 
  mutate(grade = ifelse(is.na(grade), "No HOLC grade", grade)) %>%
  #filter(grade != "No HOLC grade") %>% # Remove census blocks not within a HOLC grade
  summarise( # Find the mean of each socioeconomic variable
    mean_low_income = mean(P_LOWINCPCT, na.rm = TRUE),
    mean_pm25 = mean(P_PM25, na.rm = TRUE),
    mean_low_life_exp = mean(P_LIFEEXPPCT, na.rm = TRUE)
  ) %>% 
  pivot_longer(  
    cols = starts_with("mean_"), # Grab desired columns
    names_to = "socio_economic", # Socioeconimic variable with three levels
    values_to = "mean_value" # Associated average value
  ) 
```

9.  Use `ggplot` to: (1) create a bar graph of the average value of each
    socioeconomic variable among census block groups within a HOLC grade
    and (2) visually summarize patterns between mean environmental and
    socioeconomic variables for census blocks among HOLC grades.

```{r}
# Bar graph to plot mean value for each variable by HOLC grade
# Rename levels 
holc_summary$socio_economic <- factor(holc_summary$socio_economic, 
 levels = c("mean_low_income", "mean_low_life_exp","mean_pm25"),
 labels = c("Average Low Income", "Average Low Life Expectancy", 
            "Average Particulate Matter Concentration (PM 2.5)"))

# Define color palette
grade_colors <- c("A" = "#2ca25f", # Best rank
                  "B" = "#99d8c9",
                  "C" = "#fec44f",
                  "D" = "#de2d26") # Worst rank

# Bar graph
grade_avg_socio <- holc_summary %>% 
  ggplot(aes(x = grade, y = mean_value, fill = grade)) +
  geom_col(col = "black") + 
  facet_wrap(~ socio_economic, scales = "free_y") + # Disable autoscaling
  scale_fill_manual(values = grade_colors) +  # Apply palette
  labs(
    x = "HOLC Grade", 
    y = "Average Percentage or Percentile",
    title = "Mean Environmental Justice Indicators by HOLC Grade"
  ) +
  theme_bw() + # Set theme
  theme(legend.position = "none") # No legend

grade_avg_socio

# Store graph in figs
#ggsave("figs/Mean_EJScreen_Indicators_by_HOLC_Grade.png", plot = grade_avg_socio)
```

![](figs/Mean_EJScreen_Indicators_by_HOLC_Grade.png)

***Figure 2. Finalized graph of mean percentile of environmental justice
indicators for census blocks within or located outside a HOLC graded
redlined area.***

```{r}
# Heatmap of EJ indicators and associated average values by grade
heatmap_holc <- holc_summary %>% 
  ggplot(aes(x = socio_economic, y = grade, fill = mean_value)) +
  geom_tile(col = "black") + # Set heatmap and borders
  scale_fill_viridis_c(option = "C", # Set color scale
                       direction = -1) + # Reverse scale for higher numbers
  labs(
    x = "Environmental Justice Indicator",
    y = "HOLC Grade",
    fill = "Mean Value",
    title = "Mean Environmental Justice Indicators by HOLC Grade"
  ) +
  theme_minimal() # Set theme

heatmap_holc 

# Store graph in figs
#ggsave("figs/Heatmap_Mean_EJScreen_Indicators_by_HOLC_Grade.png", plot = heatmap_holc)
```

![](figs/Heatmap_Mean_EJScreen_Indicators_by_HOLC_Grade.png)

***Figure 3. Finalized heatmap of mean percentile of environmental
justice indicators based on census blocks within or located outside a
HOLC graded redlined area.***

It is noticeable that redlined communities with a grade of "D" ("worst"
score) have the highest average percentage of low income households
exposed to the highest average percentile of particulate matter with the
lowest average life expectancy. Communities rated "A" ("best" score),
however, have the lowest average percentage of low income households
exposed to the least average percentile of particulate matter with the
highest average life expectancy. There are about 449 census blocks
within "A" grade neighborhoods and 3,058 census blocks within "C" grade
neighborhoods. Additionally, about 2,896 census blocks (32.22%) lack a
HOLC grade, indicating gaps in coverage, areas excluded from the
original mapping, or shifts in boundaries overtime. Census blocks rated
“C” or “D” are historically labeled as “unsafe” and now outnumber areas
graded “A” or “B.” This imbalance suggests uneven patterns of urban and
human development, with “C” and “D” areas experiencing greater exposure
to air pollution and potentially higher environmental health risks,
resulting in lower life expectancy. These conditions may also contribute
to higher crime rates in lower-graded neighborhoods, especially given
the larger proportion of low-income households; however, this
relationship requires further analysis.

## Part 2: Legacy of Redlining in Biodiversity Observations

To examine the impact of historical redlining on urban biodiversity in
Los Angeles, the proportion of bird observations within each HOLC grade
from 2021-2023 was calculated and visualized with a bar graph.

10. Ensure that the spatial objects `birds` and `inequal` are in the
    same coordinate system.

```{r}
# Ensure in same CRS! 
st_crs(birds) == st_crs(inequal) 
```

11. Perform a spatial join to assign each bird observation to a HOLC
    grade polygon. Both spatial datasets were joined with
    `st_intersects` such that points (bird observations) on the borders
    of HOLC polygons were also included.

```{r}
# Assign each bird observation to a HOLC grade polygon
# st_intersects so points on borders are included in spatial 
birds_holc <- st_join(birds, inequal, join = st_intersects, left = FALSE)

# Summarize % of bird observations by HOLC grade
bird_summary <- birds_holc %>%
  st_drop_geometry() %>%  
  mutate(grade = ifelse(is.na(grade), # Replace "NA" with "No HOLC grade" if NA
                 "No HOLC grade", 
                  grade)) %>% # Else leave assigned grade untouched
  group_by(grade) %>%
  summarise(count = n()) %>% # Count observations per grade group
# Calculate % of observations in each grade over the total observations 
  mutate(percent = round(100 * (count / sum(count)), 2))
```

```{r}
# Format bird_summary using kableExtra
bird_summary %>% 
  rename(
  "Count of Bird Observations" = count, # Rename count
  "Percent of Bird Observations in HOLC Grade" = percent, # Rename percent
  "HOLC Grade" = grade) %>% # Rename grade
  kbl( # Call html format 
  caption = "Summary of Bird Biodiversity Observations by HOLC Grade") %>% # Title
  kable_styling() # Formatted borders
```

```{r}
# Redefine a pallete for each grade (% of bird observations per HOLC grade)
grade_colors <- c("A" = "#2ca25f",
                  "B" = "#99d8c9",
                  "C" = "#fec44f",
                  "D" = "#de2d26")

bird_summary %>% 
  ggplot(aes(x = grade, y = percent, fill = grade)) +
  geom_col() + 
  geom_text( 
    aes(label = paste0(percent, "%")), # Label bars with % observations in grades
    vjust = -0.5, # Adjust position to be on top
    size = 3) +
  scale_fill_manual(values = grade_colors) + # Fill with palette
  labs(
title = "Percent of Bird Observations in Redlined Neighborhoods within HOLC Grades (2021–2023)",
    x = "HOLC Grade",
    y = "Percent of Bird Observations" ) +
  theme_bw() 
```

Interestingly, areas graded “C” accounted for the largest share of bird
biodiversity observations at 35.36% while areas graded "B" had the
lowest proportion at 17.84% of observations. About 2.14% of biodiversity
observations occurred in areas without a HOLC grade, underscoring the
need to reassess and address under sampling in ungraded or excluded
regions of Los Angeles. The results are unexpected considering the
initial hypothesis that higher-rated areas would present lower
biodiversity. Importantly, the results of this analysis do not match
those made by Ellis-Soto et al. 2013. One possible reason is the sample
size; Ellis-Soto et al. sampled 195 cities as opposed to one city.
Additionally, the authors examined a 20 year temporal comparison using
historical data. In contrast, this analysis utilized a three year period
of bird observations in relation to historical (and potentially
outdated) redlining boundaries in Los Angeles. Future analyses could
expand the scope by sampling multiple cities across a larger geographic
area (ex. California) to obtain a more robust dataset and enable
comparisons of bird observations across locations with and without
historically redlined neighborhoods over an extended period of time.
